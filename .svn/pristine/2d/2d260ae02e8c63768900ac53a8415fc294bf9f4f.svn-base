using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Configuration.Install;
using System.Linq;
using System.IO;
using System.Windows;


namespace WpfVideoUploader
{
    [RunInstaller(true)]
    public partial class Installer1 : System.Configuration.Install.Installer
    {
        public Installer1()
        {
            InitializeComponent();
        }
        public override void Install(IDictionary stateSaver)
        {
            base.Install(stateSaver);
        }

        public override void Commit(IDictionary savedState)
        {
            base.Commit(savedState);
        }

        public override void Rollback(IDictionary savedState)
        {
            base.Rollback(savedState);
        }

        public override void Uninstall(IDictionary savedState)
        {
            base.Uninstall(savedState);
            try
            {
                string settingsPath = Common.SettingsFile;
                string uploadRecordFilePath = Common.UploadRecordFile;
                string videoInfoFilePath = Common.VideoInfoFile;
                string logFilePath = Common.LogFile;

                if (File.Exists(settingsPath))
                    File.Delete(settingsPath);

                if (File.Exists(uploadRecordFilePath))
                    File.Delete(uploadRecordFilePath);

                if (File.Exists(videoInfoFilePath))
                    File.Delete(videoInfoFilePath);

                if (File.Exists(logFilePath))
                    File.Delete(logFilePath);
            }
            catch
            {
                return;
            }
        }
    }
}
